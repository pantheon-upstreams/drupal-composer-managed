@import "../../partials/_partials";

/**** START - Main tansparency, menu wrappers & placement ****/

// Remove transparency
main::before {
  display: none;
}

// Lock screen
.js-prevent-scroll {
  @include bp-max(xlarge) {
    position: fixed;
    height: 100%;
    overflow: hidden;
    width: 100%;
    // Apply transparency overlay to main content
    main::before {
      display: block;
      content: "";
      background: rgba(0, 0, 0, 0.3);
      transition: all $duration * 0.25 ease-in-out;
      position: fixed; /* Sit on top of the page content */
      width: 100%; /* Full width (cover the whole page) */
      height: 100%; /* Full height (cover the whole page) */
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 2;
    }
  }

  // Offset top of overlay to header is visible
  @include bp-max(large) {
    main::before {
      top: 66px;
    }

    // For logged in users offset top
    &.user-logged-in main::before {
      top: 105px;
    }
  }

  @include bp-between(large, xlarge) {
    main::before {
      top: 175px;
    }

    // For logged in users offset top
    &.user-logged-in main::before {
      top: 225px;
    }
  }
}

.c-site-header {
  background-color: var(--color-background, #fff);
  position: relative;
  z-index: 3;

  @include bp-min(large) {
    &::before {
      background: linear-gradient(90deg, #008535 0%, #00492c 50%);
      content: "";
      left: 0;
      height: 70px;
      position: absolute;
      top: 0;
      width: 100vw;
      z-index: 0;
    }
  }
}

// Wrapper for site header
.c-site-header__inner {
  display: flex;
  justify-content: space-between;

  @include bp-min(large) {
    display: grid;
    grid-template: 70px 1fr / 1fr 2fr;
  }

  @include bp-between(large, xlarge) {
    max-width: calc(100% - 80px);
  }
}

// Wrapper for all navigation: Utility & Main Menu
.c-site-header__site-navigation {
  position: relative;
  @include bp-max(large) {
    background: linear-gradient(
      180deg,
      var(--color-surf--kelly-green) 0%,
      var(--color-surf--forest) 100%
    );
    border-top: 1px solid var(--border-color);
    width: 100%;
    max-width: 375px;
    top: 66px;
    bottom: 0;
    right: 0;
    z-index: 3;
    position: fixed;

    // For logged in users offset top
    .user-logged-in & {
      top: 105px;
    }
  }

  // Utility moves out of mobile menu, adjust placement
  @include bp-min(medium) {
    grid-area: 1 / 2;
    grid-column: span 2;
  }
}

/**** END - Main tansparency, menu wrappers & placement ****/

/**** START - Main Logo ****/
.c-site-header__logo {
  align-items: center;
  display: flex;
  justify-content: center;
  padding: 0;
  width: var(--size-width, 194px);
  z-index: 3;

  @include bp-max(medium) {
    margin: 18px 20px 18px 0;
  }

  @include bp-min(medium) {
    grid-row-start: initial;
    width: 260px;
    margin: 18px 0;
  }

  @include bp-min(large) {
    grid-row-start: 2;
    width: 280px;
    margin: 40px 0;
  }

  // Additional breakpoint for better spacing throughout sizes
  @media (min-width: 1440px) {
    width: 320px;
  }

  a,
  img {
    display: block;
    min-height: 30px;
    width: 100%;
  }
}
/**** END - Main Logo ****/

/**** START - Main Navigation ****/
.c-site-header__menu-main {
  position: fixed;
  width: 100%;

  @include bp-between(large, xlarge) {
    background: linear-gradient(
      180deg,
      var(--color-surf--kelly-green) 0%,
      var(--color-surf--forest) 100%
    );
    border-top: 1px solid var(--border-color);
    width: 100%;
    max-width: 375px;
    top: 175px;
    bottom: 0;
    right: 0;
    z-index: 3;
    position: fixed;

    // For logged in users offset top
    .user-logged-in & {
      top: 225px;
    }
  }

  // Display on desktop screens >1024px
  @include bp-min(xlarge) {
    align-items: flex-end;
    display: flex;
    justify-content: flex-end;
    flex-flow: row;
    position: relative;
    grid-row-start: 2;
  }

  // Top level menu wrapper, main menu list element
  ul.menu--main[data-depth="0"] {
    @include list--no-bullets;
    display: flex;
    margin: 0;
    padding: 0;

    // Hide duplicated links screens larger than small desktop
    @include bp-min(large) {
      .utility__link {
        display: none;
      }
    }

    // Increase spacing at top of list to account for search bar being moved
    @include bp-between(large, xlarge) {
      > li.menu__item:first-child {
        padding-top: 24px;
      }
    }
    // Mobile styles for when only main nav is in wrapper
    @include bp-max(xlarge) {
      flex-flow: column;

      > .menu__item {
        padding: 12px 15px;
      }
    }

    // On larger desktop screens
    @include bp-min(xlarge) {
      align-items: center;
      gap: 22px;
      margin: 42px 0;
    }

    // Additional breakpoint for better sizing
    @media (min-width: 1440px) {
      gap: 40px;
    }

    // On largest desktop screens
    @include bp-min(xxlarge) {
      gap: 64px;
    }
  }

  // Main menu top level item base styles (Buttons & Links share)
  ul.menu--main[data-depth="0"] > .menu__item {
    margin: 0;

    // Do not display green background unless parent is open
    &.menu__item--expanded {
      position: relative;
      transition: all $duration * 1.5 ease-in-out;
      // Add buttons toggle icons
      > button {
        background-color: #fff;
        width: 100%;

        &:hover {
          cursor: pointer;
        }

        @include bp-max(xlarge) {
          background-color: transparent;
          background-image: url("../../../../images/icons/ui-icon-add--white.svg");
          background-repeat: no-repeat;
          background-position: top right;
          text-align: left;
          transition: all $duration * 0.5 ease-in-out;
        }
      }

      &.expanded {
        @include bp-max(xlarge) {
          background: rgba(0, 0, 0, 0.25);
          transition: all $duration * 1.5 ease-in-out;

          // When open, adjust button icon
          > button {
            background-image: url("../../../../images/icons/ui-icon-minus--white.svg");
            transition: all $duration * 0.5 ease-in-out;
          }
        }
      }

      // On larger desktop control visual toggle
      @include bp-min(xlarge) {
        // Button styles when opened on desktop
        > button.menu__link[aria-expanded="true"],
        > button.menu__link:hover {
          color: var(--color-surf--black);
          line-height: 130%;
          text-decoration-line: underline;
        }

        > button[aria-expanded="true"] ~ ul.menu--main[data-depth="1"] {
          opacity: 1;
          visibility: visible;
          @include animate---visibility-opacity-transform-on;
        }
      }
    }

    // Account for user login icon
    .menu__link.menu__login {
      background-image: url("../../../../images/icons/ui-icon-user--white.svg");
      background-repeat: no-repeat;
      background-position: top left;
      display: inline-block;
      text-indent: 34px;
    }

    // Base styles for top level buttons & links
    > .menu__link,
    > button {
      // Mobile styles
      @include bp-max(xlarge) {
        color: #fff;
        font-size: 22px;
        letter-spacing: 1.8px;
        line-height: 140%;

        &:hover {
          cursor: pointer;
        }
      }

      @include bp-min(xlarge) {
        color: var(--color-surf--forest);
        font-size: 24px;
        letter-spacing: 1.5px;
        line-height: 130%;
        white-space: nowrap;

        span {
          white-space: initial;
        }
      }

      // Additional breakpoint for better sizing
      @media (min-width: 1440px) {
        font-size: 28px;
      }

      background-color: transparent;
      border: none;
      font-family: var(--font-family-condensed);
      font-weight: var(--font-weight-bold);
      margin: 0;
      padding: 0;
      text-decoration: none;
      text-transform: uppercase;
    }

    // Add underline for links
    > a.menu__link:hover {
      text-decoration: underline;
    }
  }

  // Secondary level menu wrapper styles
  ul.menu--main[data-depth="1"] {
    @include list--no-bullets;
    display: block;

    @include bp-max(xlarge) {
      .menu__item {
        margin: 0;
        padding: 12px 0;
      }

      // Hide on mobile menu screens
      .menu__item .main-menu__description {
        display: none;
      }

      .menu__link {
        color: #fff;
        font-family: var(--font-family-sans);
        font-size: 18px;
        font-weight: var(--font-weight-bold);
        line-height: 144%;
        margin-top: 12px;
        text-decoration: none;

        &:focus,
        &:hover {
          cursor: pointer;
          text-decoration: underline;
        }
      }
    }

    @include bp-min(xlarge) {
      display: grid;
      grid-template-columns: 1fr 1fr;
      padding: 32px;
      gap: 0 20px;
      margin-top: 20px;
      position: absolute;
      width: 740px;
      background: rgb(255, 255, 255);
      box-shadow: rgb(0 0 0 / 25%) 4px 4px 24px;
      transform: translateX(-38%);
      opacity: 0;
      visibility: hidden;
      @include animate---visibility-opacity-transform-off;

      // Attach particle background to menu
      background-image: url("../../../../images/textures/menu-particles.svg");
      background-repeat: no-repeat;

      .menu__item {
        background: linear-gradient(
          180deg,
          #ffffff 25.52%,
          rgba(255, 255, 255, 0.5) 100%
        );
        margin: 0;
        padding: 0;

        // All beyond the first 2 elements
        &:nth-child(n + 3) {
          padding-top: 24px;
        }
      }

      .menu__link {
        font-family: var(--font-family-body);
        font-size: 18px;
        letter-spacing: inherit;
        line-height: 144%;
        text-decoration: none;
        text-transform: capitalize;

        &:hover,
        &:focus {
          text-decoration: underline;
        }
      }
      .main-menu__description {
        font-family: var(--font-family-body);
        font-weight: 400;
        font-size: 14px;
        line-height: 148%;
        margin-top: 2px;
      }

      // Only first item should cover full left side
      .menu__item:first-child {
        grid-area: 1/1/8/1;
      }

      // First link should always be emphasized
      // If there are exactly 2 links, dislay both as emphasized links
      .menu__item:first-child,
      .menu__item:nth-last-child(-n + 2):first-child ~ .menu__item {
        padding: 32px;

        .menu__link {
          font-family: var(--font-family-condensed);
          font-weight: var(--font-weight-bold);
          font-size: 28px;
          line-height: 130%;
          letter-spacing: 1.5px;
          text-transform: uppercase;
          white-space: nowrap;
        }
        .main-menu__description {
          font-family: var(--font-family-body);
          font-weight: 400;
          font-size: 16px;
          letter-spacing: initial;
          line-height: 148%;
          text-transform: none;
          margin-top: 2px;

          // Accent arrow
          background-image: url("../../../../images/icons/ui-icon-arrow-right--green.svg");
          background-repeat: no-repeat;
          background-position: left bottom;
          padding-bottom: 40px;
        }

        &:hover,
        &:focus-within {
          .main-menu__description {
            background-image: url("../../../../images/icons/ui-icon-arrow-right--black.svg");
          }
        }
      }
    }
  }

  // Address last top menu buttons from breaking width on screens > 1200px
  ul.menu--main[data-depth="0"] > li.menu__item--expanded {
    @include bp-min(xlarge) {
      // Stop last two menus from cutting off screen
      &:nth-of-type(4),
      &:nth-of-type(5) {
        ul.menu--main[data-depth="1"] {
          right: 0px;
          transform: translateX(0px);
        }
      }
    }

    // Revert 2nd to last element to center
    @include bp-min(xxlarge) {
      &:nth-of-type(4) > ul.menu--main[data-depth="1"] {
        right: unset;
        transform: translateX(-38%);
      }
    }
  }
}
/**** END - Main Navigation ****/

/**** START - Utility Navigation ****/
.c-site-header__utilities {
  display: flex;
  flex-flow: row;
  justify-content: flex-end;
  margin: 0;
  position: relative;
  z-index: 1;

  // Only display utility nav on screens larger than 1024px
  #block-utilitynav {
    display: none;

    @include bp-min(large) {
      display: block;
    }
  }

  // Menu element styles
  ul.menu--utility-nav[data-depth="0"] {
    @include list--no-bullets;
    display: flex;
    flex-flow: row;
    margin: 0;
    padding: 0;

    .menu__item {
      margin: 0;
      padding: 19px 36px 19px 0;
    }

    @include bp-min(large) {
      .menu__link {
        color: #fff;
        font-family: var(--font-family-condensed);
        font-size: 22px;
        font-weight: var(--font-weight-bold);
        letter-spacing: 1.8px;
        line-height: 144%;
        text-decoration: none;
        text-transform: uppercase;
        white-space: nowrap;

        span {
          white-space: initial;
        }

        &:focus,
        &:hover {
          cursor: pointer;
          text-decoration: underline;
        }
      }

      // Account for user login icon
      .menu__link.menu__login {
        background-image: url("../../../../images/icons/ui-icon-user--white.svg");
        background-repeat: no-repeat;
        background-position: right;
        background-size: 20px;
        padding-right: 24px;
      }
    }
  }
}

/**** END - Utility Navigation ****/

/**** START - Mobile Navigation Button ****/
.nav-trigger {
  display: none;
  @include bp-max(xlarge) {
    grid-column-start: 2;
    align-items: center;
    background: transparent;
    border: none;
    display: inline-flex;
    height: 36px;
    margin-top: auto;
    margin-left: auto;
    margin-bottom: auto;
    max-width: 100px;
    padding: 0;
  }
}

.nav-trigger span.label {
  color: var(--color-surf--forest);
  cursor: pointer;
  font-family: var(--font-family-condensed);
  font-size: 22px;
  font-weight: var(--font-weight-bold);
  line-height: 140%;
  letter-spacing: 1.8px;
  margin-left: 6px;
  text-transform: uppercase;
}

.nav-trigger span.icon {
  width: 1.5rem;
  height: 1.5rem;
  display: inline-block;
  position: relative;
  svg {
    position: absolute;
    left: 0;
    top: 0;
  }
}

// Controls for when menu open
.nav-trigger__icon--expand {
  opacity: 1;
  transform: rotate(0) scale(1);
  transition: all $duration ease-in-out;
}

.nav-trigger__icon--collapse {
  opacity: 0;
  transform: rotate(-90deg) scale(0);
  transition: all $duration ease-in-out;
}
.nav-trigger[aria-expanded="true"] {
  .nav-trigger__icon--collapse {
    opacity: 1;
    transform: rotate(0) scale(1);
  }

  .nav-trigger__icon--expand {
    opacity: 0;
    transform: rotate(90deg) scale(0);
  }
}

// On small screens control display for both main menu & utility
@include bp-max(large) {
  .nav-trigger[aria-expanded="false"] {
    ~ .c-site-header__site-navigation {
      opacity: 0;
      visibility: hidden;
      transform: translate3d(375px, 0, 0);
      @include animate---visibility-opacity-transform-off;
    }
  }
  .nav-trigger[aria-expanded="true"] {
    ~ .c-site-header__site-navigation {
      opacity: 1;
      visibility: visible;
      overflow-y: auto;
      transform: translate3d(0, 0, 0);
      @include animate---visibility-opacity-transform-on;
    }
  }
}

// On medium screens control display for only main menu
@include bp-between(large, xlarge) {
  .nav-trigger[aria-expanded="false"] {
    ~ .c-site-header__site-navigation .c-site-header__menu-main {
      opacity: 0;
      visibility: hidden;
      transform: translate3d(375px, 0, 0);
      @include animate---visibility-opacity-transform-off;
    }
  }
  .nav-trigger[aria-expanded="true"] {
    ~ .c-site-header__site-navigation .c-site-header__menu-main {
      opacity: 1;
      visibility: visible;
      overflow-y: auto;
      transform: translate3d(0, 0, 0);
      @include animate---visibility-opacity-transform-on;
    }
  }
}

/**** END - Mobile Navigation Button ****/
