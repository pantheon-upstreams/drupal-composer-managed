{#
/**
 * @file
 * Theme implementation to display a node as a teaser.
 *
 * Available variables:
 *  See embed below
 *
 * @see template_preprocess_node()
 */
#}

{% set experiment_dates %}
  {% if content.field_dates_only|render and not node.field_dates_only.0.get('end_value').value %}
    {{ content.field_dates_only|field_value }} - {{- 'Present'|t -}}
  {% else %}
    {{ content.field_dates_only|field_value|default([]) }}
  {% endif %}
{% endset %}

{% embed 'surf_main:teaser' with {
  attributes,
  teaser_attributes: create_attribute(),
  teaser_content: content.field_overview|field_value|default([]),
  teaser_title: label,
  teaser_title_tag: 'h3',
  teaser_type: 'experiment',
  teaser_dates: experiment_dates,
  teaser_tags: content.field_ref_research_areas|field_value|default([]),
  teaser_url: path('entity.node.canonical', {'node': node.id}),
} only %}
  {% block teaser_content_suffix %}
    <div class="m-teaser__content-suffix">
      <p class="m-teaser__dates">
        {{ teaser_dates }}
      </p>
      <ul class="m-teaser__tags">
        {% for tag in teaser_tags %}
          <li>
            {{ tag }}
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endblock %}
{% endembed %}

{{ content|without(
  'field_dates_only',
  'field_overview',
  'field_ref_research_areas',
) }}