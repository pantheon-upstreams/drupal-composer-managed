{#
/**
 * @file
 * Theme implementation to display an Article Node with Full view mode.
 *
 * Available variables:
 *  - No additional variables are available for this Node type.
 *
 * @see templates/nodes/node.html.twig
 * @see components/05-pages/article/article.twig
 */
#}

{% if content.field_media_primary|render and node.field_media_primary.entity.bundle() == 'image' %}
    {% set article_layout = 'image' %}
{% elseif content.field_media_primary|render and node.field_media_primary.entity.bundle() == 'remote_video' %}
    {% set article_layout = 'video' %}
{% else %}
    {% set article_layout = 'text' %}
{% endif %}

{% set article_tags = [] %}

{% if content.field_ref_research_areas|render %}
    {% set article_tags = article_tags|merge(content.field_ref_research_areas|field_value) %}
{% endif %}

{% if content.field_ref_key_impact_areas|render %}
    {% set article_tags = article_tags|merge(content.field_ref_key_impact_areas|field_value) %}
{% endif %}

{% if content.field_ref_eo_opportunities|render %}
    {% set article_tags = article_tags|merge(content.field_ref_eo_opportunities|field_value) %}
{% endif %}

{% if content.field_ref_audiences|render %}
    {% set article_tags = article_tags|merge(content.field_ref_audiences|field_value) %}
{% endif %}

{% set rendered_content = content|without(
    'field_author',
    'field_date_published',
    'field_media_primary',
    'field_overview',
    'field_p_content',
    'field_ref_audiences',
    'field_ref_content_blocks',
    'field_ref_eo_opportunities',
    'field_ref_key_impact_areas',
    'field_ref_research_areas',
) %}

{% include 'surf_main:article' with {
    attributes,
    rendered_content,
    article_attributes: create_attribute(),
    article_author: content.field_author|field_value,
    article_body: content.field_p_content,
    article_callouts: content.field_ref_content_blocks|field_value|default([]),
    article_heading: label|field_value,
    article_layout: article_layout,
    article_media: content.field_media_primary|field_value|default([]),
    article_overview: content.field_overview|field_value,
    article_publish_date: content.field_date_published|field_value,
    article_tags: article_tags|default([]),
} only %}
