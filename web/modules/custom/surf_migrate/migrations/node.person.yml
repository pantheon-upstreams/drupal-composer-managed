id: surf_node_person
label: SURF Node -> Person
migration_group: 'surf'
migration_tags:
  - Content
source:
  plugin:  'd8_entity'
  entity_type: node
  include_translations: false
  key: 'migrate'
process:
  nid: nid
  title: title
  _skip_type:
    plugin: skip_on_value
    not_equals: true
    source: type
    method: row
    value: 
      - employee_
      - board_member_profile
  body: body
  _title_first_part:
    - 
      plugin: explode
      source: title
      delimiter: ' '
    -
      plugin: extract
      index:
        - 0
  _title_second_part:
    - 
      plugin: explode
      source: title
      delimiter: ' '
    -
      plugin: extract
      index:
        - 1
  field_name/0/given:
    - 
      plugin: null_coalesce
      source:
        - field_first_name/0/value
        - '@_title_first_part'
  field_name/0/family:
    - 
      plugin: null_coalesce
      source:
        - field_last_name/0/value
        - '@_title_second_part'
  field_overview: field_overview
  field_media_primary/0/target_id:
    -
      plugin: migration_lookup
      no_stub: true
      migration: surf_file_image
      source: field_portrait/0/target_id
    -
      plugin: file_to_media
      metadata:
        alt: 'field_portrait/0/alt'
        title: 'field_portrait/0/title'
        width: 'field_portrait/0/width'
        height: 'field_portrait/0/height'
      destination_field: field_media_image
      media_bundle: image
  field_phone_mobile: field_cell_phone
  field_phone_office: field_office_phone
  field_email: field_email
  field_board_type:
    -
      plugin: static_map
      source: field_profile_type/0/target_id
      map:
        132: sdsta
        133: cultural_advisory_committee
        137: surf_foundation
  field_appointed_by/0/value: field_appointed_by/0/value
  field_location/0/value: field_from/0/value
  uid: uid
  created: created
  changed: changed
  status: status
destination:
  plugin: entity:node
  default_bundle: 'person'
