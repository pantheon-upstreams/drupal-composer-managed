id: surf_node_contract
label: SURF Node -> Contract
migration_group: 'surf'
migration_tags:
  - content
source:
  plugin:  'd8_entity'
  entity_type: node
  bundle: 'contracts'
  include_translations: false
  key: 'migrate'
process:
  nid: nid
  title: title
  body: body
  field_ref_contacts: field_contact_person_s_
  field_ref_contract_type: field_contract_type
  field_p_contract_schedule: field_contract_schedule
  field_contract_summary: field_contract_summary
  field_overview/0/value: field_overview/0/value
  field_overview/0/format:
    plugin: default_value
    default_value: 'basic_html'
  field_ref_documents:
    plugin: sub_process
    source: field_documents
    process:
      target_id:
        -
          plugin: callback
          callable: '\Drupal\surf_migrate\MigrationCallbacks::convertDocumentNodeToFid'
          source: target_id
        -
          plugin: migration_lookup
          no_stub: true
          migration: surf_file_file
        -
          plugin: file_to_media
          destination_field: field_media_document
          media_bundle: document
  field_links:
    plugin: sub_process
    source: field_url
    process:
      uri: uri
      title: title
      options:
        plugin: default_value
        default_value: []
  uid: uid
  created: created
  changed: changed
  status: status
destination:
  plugin: entity:node
  default_bundle: 'contract'
migration_dependencies:
  required:
    - surf_node_person
    - surf_paragraph_schedule_item
